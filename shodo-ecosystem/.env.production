# ===========================
# Shodo Ecosystem Production Environment
# ===========================

# 環境設定
ENVIRONMENT=production
NODE_ENV=production
DEBUG=false

# ===========================
# データベース設定
# ===========================
POSTGRES_DB=shodo
POSTGRES_USER=shodo
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE
DATABASE_URL=postgresql+asyncpg://shodo:CHANGE_ME_STRONG_PASSWORD_HERE@postgres:5432/shodo

# ===========================
# Redis設定
# ===========================
REDIS_PASSWORD=CHANGE_ME_STRONG_REDIS_PASSWORD
REDIS_URL=redis://:CHANGE_ME_STRONG_REDIS_PASSWORD@redis:6379

# ===========================
# セキュリティ設定
# ===========================
# JWT署名用の秘密鍵（必ず変更してください）
JWT_SECRET_KEY=CHANGE_ME_VERY_LONG_RANDOM_STRING_FOR_JWT_SECRET
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# APIキー暗号化用のマスターキー（必ず変更してください）
ENCRYPTION_KEY=CHANGE_ME_32_BYTE_BASE64_ENCODED_KEY
ENCRYPTION_SALT=CHANGE_ME_RANDOM_SALT_STRING

# ===========================
# LLM設定
# ===========================
# プロバイダー選択: ollama | openai | vllm
LLM_PROVIDER=ollama

# Ollama設定
OLLAMA_HOST=host.docker.internal:11434
OLLAMA_MODEL=mistral

# OpenAI設定（使用する場合）
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_BASE_URL=http://ai-server:8001/v1

# vLLM設定（使用する場合）
VLLM_MODEL_NAME=facebook/opt-125m
VLLM_GPU_MEMORY_UTILIZATION=0.9
VLLM_MAX_MODEL_LEN=2048

# ===========================
# アプリケーション設定
# ===========================
# バックエンドAPI
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
MAX_WORKERS=4

# フロントエンド
REACT_APP_API_URL=https://api.shodo-ecosystem.com
REACT_APP_WS_URL=wss://api.shodo-ecosystem.com

# CORS設定（カンマ区切りで複数指定可能）
CORS_ORIGINS=https://shodo-ecosystem.com,https://www.shodo-ecosystem.com

# ===========================
# 外部サービス設定
# ===========================
# Shopify
SHOPIFY_API_VERSION=2024-01
SHOPIFY_WEBHOOK_SECRET=

# Stripe
STRIPE_API_VERSION=2024-01-01
STRIPE_WEBHOOK_SECRET=

# GitHub
GITHUB_APP_ID=
GITHUB_APP_PRIVATE_KEY=

# Gmail
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# Slack
SLACK_CLIENT_ID=
SLACK_CLIENT_SECRET=
SLACK_SIGNING_SECRET=

# ===========================
# 監視・ログ設定
# ===========================
# ログレベル: debug | info | warning | error | critical
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=/app/logs/shodo.log
LOG_MAX_SIZE=100M
LOG_BACKUP_COUNT=10

# Sentry（エラー監視）
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_USER=admin
GRAFANA_PASSWORD=CHANGE_ME_GRAFANA_PASSWORD

# Flower（Celery監視）
FLOWER_USER=admin
FLOWER_PASSWORD=CHANGE_ME_FLOWER_PASSWORD

# ===========================
# パフォーマンス設定
# ===========================
# キャッシュ
CACHE_TTL=3600
CACHE_MAX_SIZE=1000

# レート制限
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT=100/minute
RATE_LIMIT_BURST=20

# タイムアウト
REQUEST_TIMEOUT=30
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# ===========================
# バックアップ設定
# ===========================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=
BACKUP_S3_REGION=ap-northeast-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# ===========================
# メール設定
# ===========================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@shodo-ecosystem.com
SMTP_USE_TLS=true

# ===========================
# セッション設定
# ===========================
SESSION_SECRET_KEY=CHANGE_ME_SESSION_SECRET
SESSION_COOKIE_NAME=shodo_session
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict
SESSION_LIFETIME_HOURS=24

# ===========================
# 機能フラグ
# ===========================
FEATURE_API_KEY_MANAGEMENT=true
FEATURE_OAUTH_INTEGRATION=true
FEATURE_WEBHOOK_PROCESSING=true
FEATURE_BATCH_PROCESSING=true
FEATURE_REALTIME_SYNC=true
FEATURE_AI_SUGGESTIONS=true

# ===========================
# デプロイメント設定
# ===========================
DEPLOYMENT_ENV=production
DEPLOYMENT_REGION=ap-northeast-1
DEPLOYMENT_ZONE=ap-northeast-1a
CDN_URL=https://cdn.shodo-ecosystem.com
STATIC_URL=https://static.shodo-ecosystem.com

# ===========================
# SSL/TLS設定
# ===========================
SSL_ENABLED=true
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_DHPARAM_PATH=/etc/nginx/ssl/dhparam.pem

# ===========================
# ヘルスチェック設定
# ===========================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3