# ===================================
# Shodo Ecosystem - Environment Configuration
# ===================================
# Copy this file to .env and update the values for your environment
# 本番環境では必ずすべての値を変更してください

# ===================================
# 基本設定
# ===================================
APP_NAME=Shodo Ecosystem
APP_VERSION=5.0.0
ENVIRONMENT=development
DEBUG=true
HOST=0.0.0.0
PORT=8000
RELOAD=false
WORKERS=1

# ===================================
# データベース設定
# ===================================
POSTGRES_DB=shodo
POSTGRES_USER=shodo
POSTGRES_PASSWORD=shodo_pass_change_in_production
DATABASE_URL=postgresql+asyncpg://shodo:shodo_pass_change_in_production@postgres:5432/shodo
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20

# ===================================
# Redis設定
# ===================================
REDIS_URL=redis://redis:6379
REDIS_PASSWORD=
REDIS_POOL_SIZE=10
REDIS_DECODE_RESPONSES=true

# ===================================
# セキュリティ設定（本番環境では必ず変更）
# ===================================
SECRET_KEY=change-this-in-production-to-a-secure-random-string-of-at-least-32-characters
JWT_SECRET_KEY=change-this-jwt-secret-in-production-use-openssl-rand-base64-32
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=1
ENCRYPTION_KEY=change-this-encryption-key-in-production-use-32-byte-key

# ===================================
# CORS設定
# ===================================
CORS_ORIGINS=http://localhost:3000,http://localhost,http://frontend:3000
CORS_ALLOW_CREDENTIALS=true

# ===================================
# AI サーバー設定
# ===================================
# vLLM Server URL (ベースURL、/v1なし)
VLLM_URL=http://ai-server:8001
VLLM_TIMEOUT=30
VLLM_RETRY_COUNT=3

# AI推論エンジンの選択 (ollama または vllm)
INFERENCE_ENGINE=ollama
MODEL_NAME=llama2:7b-chat

# Ollama設定
OLLAMA_HOST=host.docker.internal:11434

# vLLM設定（vLLM使用時）
# MODEL_NAME=openai/gpt-oss-20b
QUANTIZATION=awq
GPU_MEMORY_UTILIZATION=0.95
MAX_MODEL_LEN=128000

# ===================================
# レート制限設定
# ===================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# ===================================
# LPR（Limited Proxy Rights）設定
# ===================================
LPR_TTL_HOURS=1
LPR_DEVICE_BINDING=true
LPR_SCOPE_MINIMIZATION=true
LPR_AUDIT_LOGGING=true

# ===================================
# 監査・ログ設定
# ===================================
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
SERVICE_NAME=shodo-ecosystem
AUDIT_SIGNING_KEY=change-this-audit-key-in-production

# ===================================
# キャッシュ設定
# ===================================
CACHE_TTL_SECONDS=300
CACHE_ENABLED=true

# ===================================
# 外部サービス API キー
# ===================================
# Shopify
SHOPIFY_API_KEY=
SHOPIFY_API_SECRET=

# Stripe
STRIPE_API_KEY=

# Gmail
GMAIL_API_KEY=

# Slack
SLACK_API_KEY=

# ===================================
# フロントエンド設定
# ===================================
REACT_APP_API_URL=http://localhost
REACT_APP_WS_URL=ws://localhost
REACT_APP_ENVIRONMENT=development

# Windows環境での監視設定
CHOKIDAR_USEPOLLING=false
WATCHPACK_POLLING=false

# ===================================
# 監視・メトリクス設定
# ===================================
# Grafana
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin123

# SMTP設定（アラート通知用）
SMTP_HOST=
SMTP_USER=
SMTP_PASSWORD=
GF_SMTP_ENABLED=false

# アラート通知先
CRITICAL_ALERT_EMAIL=admin@yourcompany.com
WARNING_ALERT_EMAIL=admin@yourcompany.com
ALERT_FROM_EMAIL=alerts@yourcompany.com

# Slack通知（オプション）
SLACK_WEBHOOK_URL=

# ===================================
# SSL/TLS設定
# ===================================
SSL_CERT_PATH=./nginx/ssl/cert.pem
SSL_KEY_PATH=./nginx/ssl/key.pem

# ===================================
# 本番環境専用設定
# ===================================
# Sentry（エラー追跡）
SENTRY_DSN=

# 外部監視サービス
HEALTHCHECK_URL=

# バックアップ設定
BACKUP_S3_BUCKET=
BACKUP_S3_ACCESS_KEY=
BACKUP_S3_SECRET_KEY=

# ===================================
# 開発環境専用設定
# ===================================
# テスト用設定
TEST_DATABASE_URL=postgresql+asyncpg://shodo:shodo_pass@postgres:5432/shodo_test

# デバッグ設定
ENABLE_DEBUG_TOOLBAR=false
ENABLE_PROFILING=false

# ===================================
# パフォーマンス調整
# ===================================
# ワーカー数（本番環境）
GUNICORN_WORKERS=4
GUNICORN_WORKER_CONNECTIONS=1000

# メモリ制限
MAX_MEMORY_MB=2048

# 接続プール設定
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30

# ===================================
# セキュリティ追加設定
# ===================================
# 信頼できるホスト
TRUSTED_HOSTS=localhost,127.0.0.1,shodo.local

# セッション設定
SESSION_TIMEOUT_MINUTES=30
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# ===================================
# 注意事項
# ===================================
# 1. 本番環境では必ずすべてのパスワード・秘密鍵を変更してください
# 2. SECRET_KEY, JWT_SECRET_KEY, ENCRYPTION_KEY は32文字以上の安全な値にしてください
# 3. データベースパスワードは複雑なものを使用してください
# 4. 外部サービスのAPIキーは適切に管理してください
# 5. SSL証明書は本番環境では正式なものを使用してください